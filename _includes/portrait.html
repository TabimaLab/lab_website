<<<<<<< HEAD
{%- if include.style == "small" -%}
  {%- assign width = 100 -%}
{%- else -%}
  {%- assign width = 150 -%}
{%- endif -%}

{%- assign emptyarray = "" | split: "," -%}
{%- assign id = include.slug | default: include.id | default: "" -%}
{%- assign members = site.members | default: emptyarray -%} 

{%- assign member = nil -%}
{%- for m in members -%}
  {%- if m.slug == id -%}
    {%- assign member = m -%}
  {%- endif -%}
{%- endfor -%}

{%- assign url = member.url | default: "" -%}

{::nomarkdown}
<a {% if url %}href="{{ url | relative_url }}"{% endif %} class="portrait" style="--width: {{ width }}px">

  {%- assign placeholder = "images/placeholder.svg" | relative_url -%}

  {%- assign role = member.role | default: "" -%}
  {%- if role -%}
    {%- include role.html type=role -%}
  {%- endif -%}

  {%- assign image = member.image | default: "" -%}
  <span class="portrait_image">
    <img
      src="{{ image | relative_url }}"
      onerror="this.src = '{{ placeholder }}'; this.onerror = null;"
      loading="lazy"
    >
  </span>

  {%- assign name = member.name | default: "" -%}
  {%- if name -%}
    <span class="portrait_name">
      {{ name }}
    </span>
  {%- endif -%}

  {%- assign description = member.description | default: "" -%}
  {%- if description -%}
    <span class="portrait_description">
      {{ description }}
    </span>
  {%- endif -%}

</a>
{:/}
=======
{% if include.lookup %}
  {% assign member = site.members 
    | where_exp: "member", "member.slug == include.lookup"
    | first
  %}
{% else %}
  {% assign member = include %}
{% endif %}

{% assign type = site.data.types[member.role] %}

<div class="portrait-wrapper">
  <a
    {% if page.slug != member.slug %}
      href="{{ member.url | relative_url | uri_escape }}"
    {% endif %}
    class="portrait"
    data-style="{{ include.style }}"
    aria-label="{{ member.name | default: "member link" | regex_strip }}"
  >
    {% if type %}
      {% include icon.html icon=type.icon %}
    {% endif %}

    <img
      src="{{ member.image | relative_url | uri_escape }}"
      class="portrait-image"
      alt="member portrait"
      loading="lazy"
      {% include fallback.html %}
    >

    {% if member.name %}
      <span class="portrait-name">
        {{ member.name }}
      </span>
    {% endif %}

    {% if member.description or type %}
      <span class="portrait-description">
        {{ member.description | default: type.description }}
      </span>
    {% endif %}

    {% if member.affiliation %}
      <span class="portrait-affiliation">
        {{ member.affiliation }}
      </span>
    {% endif %}
  </a>
</div>
>>>>>>> template/main
